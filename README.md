# 🌸 スプレーマム出荷予測アプリ (Spray Mum Shipment Predictor)

ハウスごとの植え付けデータから、将来の出荷数を予測・集計するアプリです。

**Live Demo URL**: [https://spray-mum-prediction.streamlit.app/](https://spray-mum-prediction.streamlit.app/) (仮)

## 📌 機能概要

*   **自動集計**: 複数のハウスの予測出荷数を日別・品種別に合算。
*   **高度なグラフ**: 品種ごとの花色を自動判定し、見やすい積み上げ棒グラフで表示。
*   **柔軟な設定**:
    *   **季節係数**: 季節（月）ごとの生育倍率をサイドバーで調整可能。
    *   **出荷パターン**: 標準の「14日間」と、短期集中型の「9日間」を切り替え可能。
*   **データ連携**:
    *   CSVファイルによる一括インポート対応。
    *   **Googleフォーム対応**: 日本語の見出し（「ハウス名」「品種」など）をそのまま読み込めます。

## 📂 ファイル構成

*   `app.py`: アプリケーションのメインコード（UI担当）。
*   `src/calc.py`: 計算ロジック（予測計算、分配率計算）を担当。
*   `requirements.txt`: 必要なPythonライブラリ一覧。
*   `docs/google_form_prompt.md`: Googleフォーム自動生成用のAIプロンプト。

## 🚀 使い方

### 1. CSVデータの準備
以下の列を含むCSVファイルを用意してください（列の順序は自由です）。
GoogleフォームからダウンロードしたCSVもそのまま使えます。

| 列名 (日本語OK) | 必須 | 説明 |
| :--- | :---: | :--- |
| **ハウス名** | ✅ | 区画の名前 (例: A-1) |
| **品種** | ✅ | 品種名 (例: セイマヌエル) |
| **面積** | ✅ | 坪数 (例: 100) |
| **消灯日** | ✅ | シェード開始日 (例: 2023-10-01) |
| **花色** | - | グラフ色分け用 (白, 赤, 黄 など) |
| **花形** | - | 分析用 (シングル, デコラ など) |
| **週数** | - | 開花所要週数 (空欄ならデフォルト7週) |
| **係数** | - | 生育係数 (空欄なら季節設定を使用) |

### 2. アプリでの操作
1.  URLを開く（またはローカルで起動）。
2.  「CSVアップロード」を選択し、ファイルをアップロード。
3.  グラフと集計表が自動生成されます。
4.  サイドバーで「季節係数」や「出荷パターン」を変更してシミュレーションできます。

## 💻 開発者向け: ローカル実行方法

```bash
# 1. 仮想環境作成 (推奨)
python -m venv venv
# Windows: venv\Scripts\activate

# 2. ライブラリインストール
pip install -r requirements.txt

# 3. アプリ起動
streamlit run app.py
```

GitHubリポジトリ: `spray-mum-prediction`
